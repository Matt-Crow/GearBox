using GearBox.Core.Model.Json;
using GearBox.Core.Model.Units;

namespace GearBox.Core.Model.Dynamic;

/// <summary>
/// Projectiles are generated by characters when they use attacks, and can inflict damage
/// </summary>
public class Projectile : IDynamicGameObject
{
    private readonly MobileBehavior _mobility;

    public Projectile(Coordinates coordinates, Velocity velocity)
    {
        Body = new()
        {
            Location = coordinates
        };
        _mobility = new(Body, velocity);
        _mobility.StartMovingIn(velocity.Angle); // MobileBehavior defaults to not moving
    }

    public BodyBehavior Body { get; init; }

    // do some of these in next commit
    // todo add a player collider thing
    // todo add a terminating thing
    // todo add max range

    public IDynamicGameObjectJson ToJson()
    {
        var result = new ProjectileJson(
            Body.Location.XInPixels, 
            Body.Location.YInPixels
        );
        return result;
    }

    public void Update()
    {
        _mobility.UpdateMovement();
    }
}